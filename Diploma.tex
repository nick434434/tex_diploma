\documentclass[a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage[russian]{babel}
\usepackage{float}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage[unicode, pdfborder = {0 0 0}, colorlinks, linkcolor = black]{hyperref}
\usepackage[raggedright]{titlesec}
\usepackage{mathtools}


\DeclarePairedDelimiter\ceil{\lceil}{\rceil}
\DeclarePairedDelimiter\floor{\lfloor}{\rfloor}


\titleformat{\chapter}[block]
  {\normalfont\huge\bfseries}{\thechapter}{20pt}{}
\titlespacing*{\chapter}
  {0pt}{20pt}{20pt}

\setcounter{tocdepth}{5}
\setcounter{secnumdepth}{5}


\parindent = 7mm
\oddsidemargin = 5mm
\topmargin = -10mm
\textheight = 240mm
\textwidth = 165mm
\linespread{1.5}


\renewcommand{\small}{\fontsize{12}{14.5pt}\selectfont}
\renewcommand{\normalsize}{\fontsize{14}{16pt}\selectfont}
\renewcommand{\large}{\fontsize{17}{20pt}\selectfont}
\renewcommand{\Large}{\fontsize{20}{25pt}\selectfont}
\renewcommand{\LARGE}{\fontsize{25}{30pt}\selectfont}
\renewcommand\qedsymbol{$\blacksquare$}

\newtheorem{theorem}{Теорема}[section]
\theoremstyle{definition}
\newtheorem{statement}{Утверждение}[section]
\newtheorem{definition}{Определение}[section]
\newtheorem*{example}{Пример}

\newenvironment{Proof}
    {{\bf \flushleft{Доказательство.} \\}}
    {\hfill$\scriptstyle\blacksquare$}


\newcounter{qcounter}


\begin{document}
\normalsize

    \thispagestyle{empty}
    \begin{titlepage}
    \begin{center}


    \vfill
    МИНОБРНАУКИ РОССИИ\\
    \vspace*{0.3cm}
    Федеральное государственное автономное образовательное\\
    учреждение высшего образования\\
    «Южный федеральный университет»\\
    \vspace*{0.3cm}
    Институт математики, механики и компьютерных наук им.\\
    И.И.Воровича\\
    Кафедра алгебры и дискретной математики
    \vfill


    \bigskip


    {\large\bf Ковалев~Никита~Евгеньевич}
    \vfill
    {\large\bf ВОССТАНОВЛЕНИЕ ЦИКЛИЧЕСКИ\\СМАЗАННЫХ ИЗОБРАЖЕНИЙ\\
               С ВЫРОЖДЕННЫМ СМАЗОМ}

\fontsize{14}{16pt}\selectfont

    \vfill
    ВЫПУСКНАЯ КВАЛИФИКАЦИОННАЯ\\ РАБОТА БАКАЛАВРА\\
    по направлению 01.03.02 — Прикладная математика и информатика
    \vfill

    {\bf Научный руководитель~---\\
         доц., к.ф.-м.н. Козак Анатолий Всеволодович}



    \vfill

    \end{center}

    \bigskip

    \begin{center}
        Ростов-на-Дону~---~2018
    \end{center}

    \end{titlepage}

%-------------------------------------
    \tableofcontents
    \newpage
%-------------------------------------


    \section*{Введение}
    \addcontentsline{toc}{section}{Введение}


    С появлением фотокамер человечество получило инструмент, позволяющий сохранять информацию о любых видимых объектах окружающей среды. Но снимки, получаемые с помощью фотокамеры, не всегда хорошего качества по многим причинам. Безусловно, фотокамеры совершенствуются людьми, и сейчас они способны устранять многие искажения еще при обработке и сохранении снимка, однако, особенно при тяжелых условиях съемки, зачастую фотографии не отражают столько информации, сколько необходимо. С развитием техники появились инструменты для работы с искаженными фото, а ЭВМ обрели вычислительную мощность, достаточную для обработки фото высокого разрешения за достаточно быстрое время. Также из всех возможных искажений выделили некоторые классы явлений, с которыми есть возмоность работать в рамках определенных методов. Одним из таких негативных эффектов является смаз (\cite{blur_def}).


    В данной работе рассматривается явление горизонтального циклического смаза. Само являение возникает при съемке местности с помощью вращающейся камеры при создании панорманых снимков. При возникновении этого явления смазанное изображение содержит большое количество искаженной (потерянной) информации, соответственно, появляется необходимость восстановить эти данные. Поскольку задача актуальна для таких областей, как военная разведка, картография, геодезия, моделирование объектов местности и аналогичных, то отснять материал заново зачастую невозможно. В силу этой специфики задача восстановления искаженных снимков приобретает наиважнейший характер.


    В реальной практике искажение происходит не только из-за смаза, но также из-за способа сохранения снимков. При обработке снимка фотокамера оцифровывает изображение с определенной точностью (в формате 8, 12 или 16 бит на пиксел), то есть переводит информацию о кадре в определенный интервал и округляет до ближайшего целого числа. Нетрудно понять, что уже на этом этапе идет потеря информации о всех объектах на изображении, и, чем больше бит отводится на пиксел, тем меньше информации теряется на первом этапе.


    В большинстве методов восстановления смаза используется подход с ядром преобразования (\cite{kernel1}-\cite{kernel2}), то есть по входному изображению находится ядро свертки, а затем вычисляется обратная свертка (деконволюция). Поскольку в данной работе исследуется горизонтальный смаз с известным видом общей матрицы, то целесообразно использовать представление смаза как обычного матричного перемножения (как, например, в \cite{model_proc}).


    По причине того, что данная задача требует выполнения перемножений матриц большого размера, а также работы с матрицами комплексных чисел, необходимо выбрать наиболее эффективный язык для реализации методов. Таковым, определенно, является MATLAB (сокр. от MATrix LABoratory; \cite{matlab}), и, так как лицензированная MATLAB-среда имеется в дисплейных классах Института математики, механики и компьютерных наук имени И.И. Воровича, то я остановился именно на ней. Это позволило добиться действительно быстрой работы описаннных в работе методов.


    Стоит отметить, что на протяжении всего учебного года мы вместе с другими студентами периодически обсуждали промежуточные результаты наших работ, а также различные тенденции в ведущих областях исследований по нашим темам. В процессе таких дискуссий рождалось множество идей для продолжения наших исследований, в том числе таким образом был придуман один из важнейших аспектов второго метода из описанных в данной работе.


%-------------------------------------
    \newpage
%-------------------------------------

    \section{Вспомогательные понятия}


    Введем некоторые обозначения и базовые понятия, которые будут использоваться в дальнейшем.
\vspace*{0.3cm}


    \begin{definition}
    \label{blur matrix}
	\emph{Матрицей горизонтального циклического смаза} (далее - \emph{матрицей смаза}) на $k$ пикселей называется матрица $C(n, k) \in M_n$ вида
    $$
    C(n, k) = \frac{1}{k}\begin{pmatrix}
          \overbrace{1 \hspace*{2mm} \ldots \hspace*{2mm} 1 \hspace*{2mm} 1}^{k} \hspace*{2mm} 0 \hspace*{2mm} \ldots \hspace*{2mm} 0 \\
          0 \hspace*{2mm} 1 \hspace*{2mm} \ldots \hspace*{2mm} 1 \hspace*{2mm} 1 \hspace*{2mm} \ldots \hspace*{2mm} 0 \\
          \ldots \hspace*{2mm} \ddots \hspace*{2mm} \ldots \hspace*{2mm} \ddots \hspace*{2mm} \ldots \\
          1 \hspace*{2mm} \ldots \hspace*{2mm} 0 \hspace*{2mm} 1 \hspace*{2mm} 1 \hspace*{2mm} \ldots \hspace*{2mm} 1 \\
          \ldots \hspace*{2mm} \ddots \hspace*{2mm} \ldots \hspace*{2mm} \ddots \hspace*{2mm} \ldots\\
          \underbrace{1 \hspace*{2mm} \ldots \hspace*{2mm} 1}_{k-1} \hspace*{2mm} 0 \hspace*{2mm} 0 \hspace*{2mm} \ldots \hspace*{2mm} 1
        \end{pmatrix}
    $$
    \end{definition}


    В дальнейшем будем отождествлять понятие матрицы смаза и обозначения $C(n, k)$ и просто $C$ (если параметры $n$ и $k$ ясны из контекста).
\vspace{0.3cm}


    \begin{definition}
    \label{blur}
	\emph{Горизонтальным циклическим смазом} (далее - \emph{смазом}) будем называть умножение изображения на соответствующую матрицу смаза справа.
    \end{definition}


    \begin{statement}[об обратимости матрицы смаза]
    \label{inverse}
	Матрица смаза обратима тогда и только тогда, когда НОД$(n, k) = 1$.
    \end{statement}


    Следствием \ref{inverse} является, среди прочего, большее количество изображений с вырожденным смазом, нежели с невырожденным, что лишний раз подтверждает актуальность поставленной задачи.


    \begin{statement}[о представлении матрицы смаза]
    \label{fourier}
        Матрица смаза всегда представима в виде $FDF^{-1}$, где $F$ и $F^{-1}$ - соответственно прямое и обратное дискретные преобразования Фурье (\cite{fft_def}), а $D$ - диагональная матрица, причем на диагонали - собственные значения матрицы $C$, и такое представление единственно.

    \end{statement}

    \begin{example}
    Приведем пример изображений и их смазанные варианты.

\begin{minipage}{70mm}
    \begin{figure}[H]
            \includegraphics[scale=0.065]{G:/Study/tex_diploma/Pictures/fig1.png}
            \label{Fig1}
            \caption[Смаз при $k$ = 248]{Смаз при $k$ = 248}
        \end{figure}
\end{minipage}
\hfill
\begin{minipage}{70mm}
  \begin{figure}[H]
            \includegraphics[scale=0.065]{G:/Study/tex_diploma/Pictures/fig2.png}
            \label{Fig2}
            \caption[Исходное изображение]{Исходное изображение}
        \end{figure}
\end{minipage}
\hfill
\vspace*{3mm}


Это изображение хорошо для исследования реальных ситуаций, так как оно является панорамным, то есть левая часть фото продолжает правую. Тем не менее, на самом деле, для качественного изучения результатов достаточно взять любое изображение.


\begin{minipage}{70mm}
    \begin{figure}[H]
            \includegraphics[scale=0.14]{G:/Study/tex_diploma/Pictures/8_smaz248.png}
            \label{Fig_8s}
            \caption[Смаз при $k$ = 248]{Смаз при $k$ = 248}
        \end{figure}
\end{minipage}
\hfill
\begin{minipage}{70mm}
  \begin{figure}[H]
            \includegraphics[scale=0.14]{G:/Study/tex_diploma/Pictures/8.png}
            \label{Fig_8}
            \caption[Исходное изображение]{Исходное изображение}
        \end{figure}
\end{minipage}
\hfill


    \end{example}

%--------------------------------------
    \newpage
%-------------------------------------


    \section{Метод предобработки в случае большого числа смаза}


    В первом параграфе пойдет речь о методе, который эффективен только для восстановления 16-битных изображений, поскольку данный подход использует обычное восстановление для невырожденного случая, а оно эффективно только для 16-битных изображений. Для 8-битного изображения даже при высокой (в том числе идеальной) математической точности на восстановленном фото появляется шум (\cite{noise}). В силу этих ограничений метод интересен не столько своей практической пригодностью, сколько подходом, который, возможно, применим в комбинации с лучшим методом восстановления.


    Подход заключается в следующем: в случае вырожденного смаза имеем $d =$ НОД$(n, k) > 1$, где $k$ - число смаза, $n$ - ширина изображения в пискелях. Тогда поделим исходное изображение $I$ на $d$ подизображений, каждое из которых содержит $i$-й столбец и далее каждый столбец, на $d$ правее предыдущего выбранного. В итоге получим последовательность $\{I_j\}_{j=1}^{d}$, каждое изображение которой содержит $\frac{n}{d}$ пискелей в ширину. Однако, каждое из этих изображений будет содержать смаз уже не на $k$, а на $\frac{k}{d}$, и, так как $d =$ НОД$(n, k)$, то НОД$(\frac{n}{d}, \frac{k}{d}) = 1$, следовательно, смаз невырожденный. Восстанавливая $I_j$ и объединяя их по тому же принципу, по какому происходило и разделение, мы получим изображение, содержащее смаз на $d$ пикселей. Объясняется это тем, что каждая из восстановленных картинок предоставляет $\frac{1}{d}$ информации от необходимой, но информация разных частей не является уникальной - все они несут примерно одну и ту же информацию. Это подтверждается экспериментально на реальных примерах.

\newpage

\begin{example}

Первый пример демонстрирует случай работы с 16-битными входными данными. Здесь НОД двух параметров больше единицы, но незначительно (в данном случае, 16), и в таком случае восстановление происходит достаточно качественно и, возможно, даже не требует дальнейшего восстановления (в зависимости от задачи).

\begin{minipage}{70mm}
    \begin{figure}[H]
            \includegraphics[scale=0.16]{G:/Study/tex_diploma/Pictures/fig3.png}
            \label{Fig3}
            \caption[Смаз при $k$ = 592]{Смаз при $k$ = 592}
        \end{figure}
\end{minipage}
\hfill
\begin{minipage}{70mm}
  \begin{figure}[H]
            \includegraphics[scale=0.16]{G:/Study/tex_diploma/Pictures/fig4.png}
            \label{Fig4}
            \caption[Улучшенное фото]{Улучшенное фото}
        \end{figure}
\end{minipage}
\hfill

\end{example}
\vspace*{10mm}
\begin{example}

Второй пример показывает, что метод действительно работает плохо для 8-битных изображений. Тем не менее, хотя на данный момент преимущественно именно такой формат используется в фотокамерах, уже существует техника, которая сохраняет фото в 12-битном формате, и скоро получится внедрить и 16-битный формат, что позволит использовать данный метод в полном объеме, поскольку он быстрее любого другого за счет деления проблемы на подзадачи меньшего размера. Также стоит отметить, что даже такой результат может оказаться достаточным, так как границы объектов вырисовываются достаточно четко.

\begin{minipage}{70mm}
    \begin{figure}[H]
            \includegraphics[scale=0.16]{G:/Study/tex_diploma/Pictures/fig5.png}
            \label{Fig3}
            \caption[Улучшение при $d$ = 2, $k$~=~242]{Улучшение при $d$ = 2, $k$~=~242}
        \end{figure}
\end{minipage}
\hfill
\begin{minipage}{70mm}
  \begin{figure}[H]
            \includegraphics[scale=0.16]{G:/Study/tex_diploma/Pictures/fig6.png}
            \label{Fig4}
            \caption[Улучшение при $d$ = 8, $k$~=~248]{Улучшение при $d$ = 8, $k$~=~248}
        \end{figure}
\end{minipage}
\hfill

\vspace*{5mm}


Также этот пример иллюстрирует характер поведения результата в зависимости от параметра - чем больше $d$, тем более смазан оказывается результат, но с другой стороны, меньшее $d$ не позволяет нивелировать недостатки 8-битного невырожденного восстановления из-за большого числа смаза для вырезанных частей исходного изображения. Из этого следует ожидаемый вывод, что данный метод работает лучше при больших $d$.

\end{example}


%--------------------------------------
    \newpage
%-------------------------------------


    \section{Метод минимизации погрешности}

    \subsection{Описание проблемы}


    Больший интерес представляют методы, которые позволяют избавиться от смаза полностью. Учитывая специфику уравнения смаза $XC = S$, где~$X$~-~исходное~изображение, $C$~-~матрица~смаза и~$S$~-~смазанное~изображение, получим, что для идеального математически восстановления необходимо найти обратную к $C$ матрицу и домножить на нее справа. Конечно, на практике это либо дает плохой результат (случай невырожденного смаза), либо невозможно (случай вырожденного смаза) в силу особенностей задачи, а именно, матрицы смаза.


\begin{example}

Данный пример иллюстрирует, что необходимость в улучшении обычного восстановления для случая 8-битных входных данных действительно имеется даже для невырожденного случая. Здесь число смаза равно 491, то есть является простым числом, следовательно, смаз невырожденный.

\begin{minipage}{70mm}
    \begin{figure}[H]
            \includegraphics[scale=0.065]{G:/Study/tex_diploma/Pictures/fig7.png}
            \label{Fig3}
            \caption[Восстановление 16-битного входа]{Восстановление

 16-битного входа}
        \end{figure}
\end{minipage}
\hfill
\begin{minipage}{70mm}
  \begin{figure}[H]
            \includegraphics[scale=0.065]{G:/Study/tex_diploma/Pictures/fig8.png}
            \label{Fig4}
            \caption[Восстановление 8-битного~входа]{Восстановление

 8-битного~входа}
        \end{figure}
\end{minipage}
\hfill
\end{example}
\vspace*{2mm}


    Первым препятствием является тот факт, что матрица смаза необратима при НОД$(n, k) = 1$, где $k$~-~число~смаза. Это означает, что в этом случае мы можем получить только приближенно-обратную матрицу, то есть такую матрицу $\tilde{C}$, что $C\tilde{C} \approx E$. Вторым ограничением является формат данных, с которым приходится работать при обработке изображений. В момент получения кадра изображение оцифровывается~---~непрерывная картина из окружающего мира приближается сеткой из пикселей, а значение каждого пикселя (интесивности цвета в точке) в свою очередь округляется до ближайшего целого. Таким образом, уже на данном этапе происхоит потеря огромного количества информации за счет погрешности округления.


    Имея в виду вышесказанное, необходимо сконструировать матрицу так, что при умножении на матрицу смаза справа она дает приближение единичной матрицы~---~это даст сохранение результата, максимально приближенного к исходному теоретически, а также учесть уже имеющуюся погрешность округления и минимизировать погрешность вычислений.


    \subsection{Возможные пути решения}


    Известно, что матрица смаза представима в виде $C = FDF^{-1}$, где $D$~-~диагональная матрица, причем на диагонали~-~собственные числа матрицы $C$, а $F$~-~дискретное преобразование Фурье соотвтетствующего размера. Понятно, что в случае, когда матрица полного ранга, ее обратная находится обращением всех чисел на диагонали. Известно, что обычный инверсный способ (\cite{model_proc}) может быть улучшен путем добавления регуляризационного фактора (\cite{addition}). Будем действовать по этому принципу с учетом специфики нашей задачи, тогда:


    \begin{list}{\arabic{qcounter})~}{\usecounter{qcounter}}
        \item Необратимость будем устранять заменой нулевых собственных чисел на некоторые числа с фиксированным модулем (модуль, так как собственные числа являются комплексными);
        \item Погрешность вычислений минизируем тем же способом~-~к ненулевым собственным числам, которые сильно малы по модулю, прибавим случайное комплексное число с тем же фиксированным модулем;
        \item Кроме того, оставшиеся достаточно малые собственные числа домножим так, чтобы по модулю они были равны фиксированному числу.
    \end{list}



    После соответствующих опреаций мы получим вместо матрицы $D^{-1}$, которая, вообще говоря, не всегда существует, некоторую матрицу $\tilde{D}$ такую, что $D\tilde{D} \approx E$ и $\tilde{C} = F\tilde{D}F^{-1}$. Рассмотрим, каким образом эти два преобразования повлияют на результат в теории и на практике. Эти результаты будут отличаться не только потому, что в реальной проблеме существуют погрешности, но так же и в силу особенностей порядка операций.


    \subsection{Особенности реализации на практике}


    В теории исходная матрица $X$ восстанавливается следующим порядком действий:

    $$S  F\tilde{D}F^{-1} = (X FDF^{-1}) F\tilde{D}F^{-1} = X FD\tilde{D}F^{-1},$$ то есть в идеализированной модели результат будет зависеть от того, насколько полученные числа на диагонали будут близки к числам, обратным к собственным. Также отдельно стоит отметить нулевые собственные числа - на что бы их не умножили, они останутся нулями, и соотвтествующие подобранные значения в матрице $\tilde{D}$ никакой роли не сыграют. На практике все выглядит немного иначе, поскольку матрица $S$ не расщепляется на составные части. Таким образом, влияние чисел, соответствующих нулевым собственным значениям, оказывается вполне реальным, поскольку итоговое приближение исходной матрицы $X$ будет выглядеть не иначе как $S (F\tilde{D}F^{-1}) = S\tilde{C}$. Соответственно, необходимо учитывать и этот фактор.


    \subsubsection{Поправка по умножению}


    Рассмотрим случай, когда сильно малых собственных значений не наблюдается. Тогда для каждого из них будет существовать некая поправка по умножению $\delta_i, i = \overline{0, n-1}$, а поправка по сложению не влияет на конечный результат. Это позвоялет нам рассматривать данный случай так же, как в теории, где внутренние преобразования Фурье взаимоуничтожаются. Обозначим $\tilde{E} = D\tilde{D}$, тогда:


    $$X = S \tilde{C} = X F\tilde{E}F^{-1},~~
    \tilde{E} = \begin{pmatrix}
          \frac{d_0}{d_0\delta_0} \hspace*{2mm} 0 \hspace*{4mm} \ldots \hspace*{10mm} 0 \\
          \hspace*{2mm} 0 \hspace*{2mm} \frac{d_1}{d_1\delta_1} \hspace*{2mm} \ldots \hspace*{10mm} 0 \\
          \ldots \hspace*{2mm} \ldots \hspace*{2mm} \ddots \hspace*{3mm} \ldots \\
          0 \hspace*{4mm} 0 \hspace*{2mm} \ldots \hspace*{2mm} \frac{d_{n-1}}{d_{n-1}\delta_{n-1}}
        \end{pmatrix} = \begin{pmatrix}
          \delta_0^{-1} \hspace*{5mm} 0 \hspace*{2mm} \ldots \hspace*{6mm} 0 \\
          \hspace*{2mm} 0 \hspace*{5mm} \delta_1^{-1} \hspace*{1mm} \ldots \hspace*{6mm} 0 \\
          \ldots \hspace*{2mm} \ldots \hspace*{2mm} \ddots \hspace*{3mm} \ldots \\
          0 \hspace*{4mm} 0 \hspace*{2mm} \ldots \hspace*{5mm} \delta_{n-1}^{-1}
        \end{pmatrix},
    $$ где $d$ - вектор собственных чисел матрицы $C$.


    Обозначим получившуюся матрицу $R = F\tilde{E}F^{-1}$. Тогда $R_{ij} = \frac{1}{n}\Sigma_{k=0}^{n-1} \delta_k^{-1} \xi^{(j-i)k}$, где $\xi$ есть первый корень из единицы степени $n$  $(e^{\frac{2\pi}{n}})$. Получим, что диагональные элементы $R$ равны между собой и равняются среднему величин обратных к поправкам по умножению, а элементы вне диагонали есть взвешенные средние $n$ различных корней из единицы. Важным замечением является тот факт, что эти корни различны для элементов на разных диагоналях, поскольку при удалении от главной диагонали угол между сосденими корнями $(\xi^{(j-i)k}$ и $\xi^{(j-i)(k+1)})$ увеличивается, и, соответственно, различные симметричные свойства теряются. Например, на первой диагонали, которая находится выше главной, "базовый" корень есть не что иное, как $\xi$, и, чтобы минимизировать элементы на этой диагонали, необходимо, чтобы вторая половина вектора поправок по умножению в точности повторяла первую ($\delta_0 = \delta_{\floor{\frac{n-1}{2}}+1}, \delta_1 = \delta_{\floor{\frac{n-1}{2}}+2}$ и т.д.), тогда как уже на второй диагонали условие для минимизации меняется на $\delta_i = -\delta_{\floor{\frac{n-1}{2}}+i+1}$. Таким образом, объединить условия для разных диагоналей не представляется возможным, даже если использовать поправки только для малого количества собственных значений. Это означает, что поправки по умножению, несмотря на то, что имеют детерминистскую природу, не позволяют достичь хороших результатов (кроме, конечно, случая, когда $\delta_i = \delta_j~ \forall~ i, j\in \overline{0, n-1}$, о нем пойдет речь в следующем пункте).


\begin{minipage}{70mm}
    \begin{figure}[H]
            \includegraphics[scale=0.6]{G:/Study/tex_diploma/Pictures/graph1.pdf}
            \label{Graph1}
            \caption[Собственные числа для первой диагонали после главной]{Собственные числа для первой диагонали после главной}
        \end{figure}
\end{minipage}
\hfill
\begin{minipage}{70mm}
  \begin{figure}[H]
            \includegraphics[scale=0.6]{G:/Study/tex_diploma/Pictures/graph2.pdf}
            \label{Graph2}
            \caption[Собственные числа для второйдиагонали после главной]{Собственные числа для второй диагонали после главной}
        \end{figure}
\end{minipage}
\hfill
\vspace*{2mm}


    \subsubsection{Поправка по сложению}


    С поправкой по сложению все иначе. В теоретическом представлении задачи она позволяет лишь только осуществить псевдообращение матрицы смаза, но сами числа, которые мы прибавим, никоим образом не повлияют на результат. Следовательно, необходимо рассматривать матрицу

$\tilde{D}~=~diag(\frac{1}{d_0~+~\sigma_0},~\frac{1}{d_1~+~\sigma_1},~...,~\frac{1}{d_{n-1}~+~\sigma_{n-1}})$, где $\sigma$ - вектор значений поправки по сложению. Тогда аналогично п.3.3.1, положив $\gamma_i = d_i + \sigma_i$, $\tilde{R} = F\tilde{D}F^{-1}$, получим, что $\tilde{R}_{ij} = \frac{1}{n}\Sigma_{k=0}^{n-1} \gamma_k^{-1} \xi^{(j-i)k}$. Из уже приведенных рассуждений известно, что подбор для каждой отдельной диагонали не имеет смысла, соотвтественно, необходимо использовать новый подход. Так как для поправки по сложению мы отбираем числа с модулем, близким к или равным нулю, то соответствующие "обратные" собственные числа оказываются очень велики по модулю. Конечно, этого следует избегать, поскольку и так имеющаяся погрешность будет дополнительно усилена погрешностью вычислений. Поэтому, учитывая специфику поведения $R_{ij}$, перспективной выглядит идея установить для чисел $d_i$, которые попадают под условие на поправку по сложению, соответствующее $\sigma_i$ сделать фиксированным числом для любого такого $d_i$. Тогда, так как для каждого собственного числа на первой диагонали после главной имеется пара, то и на последующих диагоналях найдутся пары для новых чисел, которые взаимоуничтожатся при равных коэффициентах перед ними.  Тем не менее, поскольку поправка применяется не ко всем, а только к малым по модулю числам, некое подобие структуры, присущей исходной матрице, остается, и за счет этого восстановление остается возможным с теоретической точки зрения (теряются не все свойства матрицы).


    Действительно, оказывается, именно такой подход, единственный математически оправданный, является удачным и позволяет найти баланс между теоретической точностью и практической минимизацией погрешности. Примеры так же показывают, что для достижения этих результатов подойдет не только некая константа для всего вектора, но так же случайные комплексные числа с фиксированным модулем, причем постоянство модуля является определяющим свойством системы.

%---------------------------
\newpage
%---------------------------

\subsubsection{Сравнение поправок на практике}


\begin{example}

Данное восстановленное фото показывает, что изменение части <<обратных>>  собственных чисел при помощи поправки по умножению дает худший результат, чем восстановление без поправок, тем самым подвтерждая, что математическая (теоретическая) точность теряется.


\begin{minipage}{150mm}
    \begin{figure}[H]
            \includegraphics[scale=0.14]{G:/Study/tex_diploma/Pictures/fig9.png}
            \label{Pic9}
            \caption[Восстановление с поправкой по умножению 16-битного фото]{Восстановление с поправкой по умножению 16-битного фото}
        \end{figure}
\end{minipage}
\hfill
\vspace*{2mm}

\end{example}


\newpage


\begin{example}

Этот пример иллюстрирует восстановление на примере 8-битного изображения. Хорошо видно, что математическая точность пострадала ввиду изменения структуры матрицы путем изменения собственных значений, но, тем не менее, большая часть различимых деталей видна, что явялется следствием минимизации погрешности.


\begin{minipage}{150mm}
  \begin{figure}[H]
            \includegraphics[scale=0.14]{G:/Study/tex_diploma/Pictures/fig10.png}
            \label{Pic10}
            \caption[Восстановление с применением поправки по сложению]{Восстановление с применением поправки по сложению}
        \end{figure}
\end{minipage}
\hfill
\vspace*{2mm}

\end{example}


Необходимо отметить, что в случае использования поправки по сложению оба типа изображений дают практически или совсем одинаковые результаты. Это говорит о том, что погрешность вычислений действительно удалось устранить или минимизировать, что лишний раз подтверждает приведенные выше рассуждения.



\newpage


\addcontentsline{toc}{section}{Список литературы}
\begin{thebibliography}{9}
\bibitem{blur_def}
Грузман И.С. Цифровая обработка изображений в информационных системах. / И.С.~Грузман, В.С.~Киричук, В.П.~Косых, Г.И.~Перетягин, А.А.~Спектор. Учебное пособие. --- Новосибисрк: Изд-во~НГТУ,~2002.~---~352~c.

\bibitem{kernel1}
Переславцева~Е.В. Двухфазная оценка ядра для устойчивого к ошибкам восстановления изображения, смазанного при движении. / Е.В.~Переславцева, М.В.~Филлипов. // Вестник МГТУ им. Н.Э. Баумана --- Сер.~``Приборостроение''~---~2012~---~C. 136-148.

\bibitem{kernel2}
Blind Deconvolution --- автоматическое восстановление смазанных изображений [Электронный ресурс]. --- Режим доступа https://habr.com/post/175717/. --- Заглавие с экрана. --- (Дата обращения - 12.06.2018).

\bibitem{model_proc}
Ежова К.В. Моделирование и обработка изображений. / К.В.~Ежова. Учебное пособие. --- СПб: НИУ ИТМО, 2011. --- 93 с.

\bibitem{matlab}
MATLAB Documentation [Электронный ресурс]. --- Режим доступа: https://www.mathworks.com/help/matlab/. --- Заглавие с экрана. --- (Дата обращения - 27.05.2018).

\bibitem{fft_def}
Сергиенко А.Б. Цифровая обработка сигналов. / А.Б.~Сергиенко. --- СПб.: Питер, 2002. --- 608 с.

\bibitem{noise}
Сазонов В.В. Восстановление слабоконтрастных изображений. / В.В. Сазонов, М.А. Щербаков. // International Scientific Conference
``Advanced Information Technologies and Scientific Computing'' --- 2014 --- С. 343-346.

\bibitem{addition}
Дайнеко М.В. Восстановление смазанных под углом и зашумленных изображений без учета граничных условий. / М.В. Дайнеко, В.С. Сизиков. // Научно-технический вестник Санкт-Петербургского университета информационных технологий, механики и оптики --- 2010 --- №4(68) --- С. 28-32.

\end{thebibliography}


\end{document}






